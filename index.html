<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>AIMuse Portraits | AI 女神畫廊</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet" />
  <style>
    :root{
      /* 全站色票 – 柔和高雅 */
      --ink:#1E1A2B;            /* 夜藍墨色 */
      --plum:#4A2C4E;           /* 深梅紫 */
      --rose:#B65C7A;           /* 乾燥玫瑰 */
      --blush:#E7B0C4;          /* 霧粉腮紅 */
      --pearl:#F7EEF3;          /* 珍珠粉白 */
      --champagne:#E7D7C9;      /* 香檳金米 */
      --soft-shadow: 0 15px 35px rgba(0,0,0,.12);
    }

    body{background:linear-gradient(180deg,var(--pearl),#ffffff); color:var(--ink)}

    /* 首屏（女神鏡面） */
    .hero-section{
      background:linear-gradient(135deg, var(--plum) 0%, var(--rose) 50%, var(--blush) 100%);
      color:#fff; padding:60px 0; position:relative; overflow:hidden;
    }
    .hero-section::before{content:''; position:absolute; inset:0; background:radial-gradient(1200px 400px at 20% -10%, rgba(255,255,255,.18), transparent), radial-gradient(800px 400px at 120% 0%, rgba(255,255,255,.12), transparent)}
    .hero-content{position:relative; z-index:2}
    .hero-title{font-size:3.25rem; font-weight:800; letter-spacing:.5px; margin-bottom:1rem; text-shadow:0 6px 24px rgba(0,0,0,.25)}
    .hero-subtitle{font-size:1.25rem; opacity:.95}
    .ai-badge{display:inline-block; background:rgba(255,255,255,.16); padding:8px 16px; border-radius:999px; font-size:.95rem; margin-bottom:1rem; backdrop-filter:blur(10px); border:1px solid rgba(255,255,255,.35)}

    /* 輪播（典藏展牆） */
    .enhanced-carousel{position:relative; max-width:1200px; margin:0 auto; border-radius:20px; overflow:hidden; box-shadow:var(--soft-shadow)}
    .carousel-container{position:relative; width:100%; height:500px; overflow:hidden; cursor:grab; user-select:none; background:#000}
    .carousel-container:active{cursor:grabbing}
    .carousel-track{display:flex; height:100%; transition:transform .5s cubic-bezier(.25,.46,.45,.94); will-change:transform}
    .carousel-slide{min-width:100%; height:100%; position:relative}
    .carousel-slide img{width:100%; height:100%; object-fit:cover; display:block}

    .carousel-nav{position:absolute; top:50%; transform:translateY(-50%); background:rgba(182,92,122,.95); border:none; width:50px; height:50px; border-radius:50%; display:flex; align-items:center; justify-content:center; cursor:pointer; transition:all .3s ease; z-index:10; box-shadow:0 4px 12px rgba(0,0,0,.18)}
    .carousel-nav:hover{background:rgba(182,92,122,1); transform:translateY(-50%) scale(1.08)}
    .carousel-nav.prev{left:20px}
    .carousel-nav.next{right:20px}
    .carousel-nav i{font-size:18px; color:#fff}

    .carousel-indicators{position:absolute; bottom:20px; left:50%; transform:translateX(-50%); display:flex; gap:10px; z-index:10}
    .carousel-indicator{width:12px; height:12px; border-radius:50%; background:rgba(255,255,255,.55); cursor:pointer; transition:all .3s ease; border:2px solid transparent; flex-shrink:0}
    .carousel-indicator.active{background:var(--blush); transform:scale(1.2); border-color:#fff}

    /* 瀑布流（靈感牆） */
    .masonry-container{max-width:1400px; margin:0 auto; padding:0 15px}
    .masonry-grid{position:relative}
    .grid-sizer{width:calc(25% - 12px)}
    .grid-item{width:calc(25% - 12px); margin-bottom:15px; box-sizing:border-box}
    .card{border-radius:16px; overflow:hidden; transition:transform .3s ease, box-shadow .3s ease; background:#fff; border:none}
    .card:hover{transform:translateY(-6px); box-shadow:0 16px 28px rgba(0,0,0,.18)}
    .card-img-top{width:100%; height:auto; object-fit:cover; display:block; cursor:pointer; transition:opacity .3s ease}
    .card-img-top:not(.loaded){opacity:0}
    .card-img-top.loaded{opacity:1}

    /* 影像燈箱（作品誌） */
    #imageModal{display:none; position:fixed; z-index:2000; left:0; top:0; width:100%; height:100%; background-color:rgba(0,0,0,.96); padding:0}
    #imageModal.show{display:flex}
    .modal-content-wrapper{display:flex; width:100%; height:100%; align-items:center; justify-content:center; position:relative}
    .modal-image-container{flex:1; display:flex; align-items:center; justify-content:center; padding:20px; max-width:70%}
    #modalImage{max-width:100%; max-height:90vh; transition:transform .3s ease; border-radius:12px; object-fit:contain; cursor:zoom-in; background:transparent}
    #modalImage.zoomed{cursor:zoom-out; transform:scale(1.5)}
    .modal-info-panel{width:360px; height:100%; background:linear-gradient(135deg, rgba(74,44,78,.98) 0%, rgba(182,92,122,.98) 100%); backdrop-filter:blur(20px); padding:30px; overflow-y:auto; box-shadow:-5px 0 20px rgba(0,0,0,.3); color:#fff; position:relative}
    .modal-info-panel::before{content:''; position:absolute; inset:0; background:url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" fill="white" opacity="0.05"><circle cx="20" cy="20" r="2"/><circle cx="80" cy="40" r="1.5"/><circle cx="40" cy="70" r="1"/><circle cx="70" cy="85" r="2"/><circle cx="10" cy="60" r="1.5"/></svg>'); pointer-events:none}
    .info-content{position:relative; z-index:1}
    .info-title{font-size:1.5rem; font-weight:800; margin-bottom:20px; padding-bottom:15px; border-bottom:2px solid rgba(255,255,255,.25); display:flex; align-items:center; gap:10px}
    .info-section{margin-bottom:22px}
    .info-label{font-size:.9rem; color:var(--champagne); margin-bottom:8px; font-weight:700; text-transform:uppercase; letter-spacing:1px}
    .info-value{font-size:1rem; line-height:1.7; background:rgba(255,255,255,.12); padding:12px 15px; border-radius:10px; border-left:3px solid rgba(231,176,196,.9)}
    .close-btn{position:absolute; top:20px; right:20px; color:#fff; font-size:30px; font-weight:900; cursor:pointer; transition:all .3s ease; z-index:2001; background:rgba(74,44,78,.85); width:46px; height:46px; border-radius:50%; display:flex; align-items:center; justify-content:center; backdrop-filter:blur(10px)}
    .close-btn:hover{background:rgba(74,44,78,1); transform:scale(1.08)}

    /* 其他 */
    .loading{text-align:center; padding:20px; color:#666; font-size:16px}
    .loading::after{content:''; display:inline-block; width:20px; height:20px; border:2px solid #ccc; border-radius:50%; border-top-color:#666; animation:spin 1s ease-in-out infinite; margin-left:10px}
    #endMessage{font-size:16px; color:#6c757d; padding:30px 20px; margin-top:20px; border-top:1px solid #dee2e6; background:linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%); border-radius:8px; box-shadow:0 2px 4px rgba(0,0,0,.1)}
    .image-placeholder{background:linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%); background-size:200% 100%; animation:loading 1.5s infinite; min-height:200px; border-radius:16px}

    @keyframes spin{to{transform:rotate(360deg)}}
    @keyframes loading{0%{background-position:200% 0}100%{background-position:-200% 0}}

    /* 響應式 */
    @media (max-width:1200px){.grid-sizer,.grid-item{width:calc(33.333% - 10px)} .hero-title{font-size:2.8rem}}
    @media (max-width:768px){.grid-sizer,.grid-item{width:calc(50% - 8px)} .grid-item{margin-bottom:12px} .hero-title{font-size:2.2rem} .hero-subtitle{font-size:1.05rem} .carousel-container{height:300px} .carousel-nav{width:40px; height:40px} .carousel-nav.prev{left:10px} .carousel-nav.next{right:10px}}
    @media (max-width:576px){.grid-sizer,.grid-item{width:100%} .grid-item{margin-bottom:10px} .masonry-container{padding:0 10px} .hero-title{font-size:1.85rem} .hero-section{padding:40px 0} .carousel-container{height:250px}}
  </style>
</head>
<body>
  <!-- 導覽列 -->
  <nav class="navbar navbar-expand-lg navbar-dark" style="background:linear-gradient(90deg, var(--ink), var(--plum))">
    <div class="container">
      <a class="navbar-brand fw-bold" href="/">
        <i class="fa-solid fa-sparkles me-2"></i>AIMuse Portraits | AI 女神畫廊
      </a>
    </div>
  </nav>

  <!-- 首屏（女神鏡面） -->
  <section class="hero-section">
    <div class="container">
      <div class="hero-content text-center">
        <div class="ai-badge">
          <i class="fas fa-robot me-2"></i>AI 繪像引擎 × 風格融合
        </div>
        <h1 class="hero-title">AIMuse Portraits</h1>
        <p class="hero-subtitle">
          以人工智慧捕捉光影與氣質，
          呈現極致雅緻的 AI 美女肖像畫典藏。
        </p>
        <div class="row justify-content-center mt-4">
          <div class="col-md-8">
            <p class="lead">
              自研美學演算 × 精選風格模型 × 專業策展流程<br>
              <span style="font-size: 12px; color: #f0e6eb; opacity:.9">合作洽談：contact@aimuse.art</span>
            </p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- 典藏展牆（輪播） -->
  <div class="container my-5">
    <div class="enhanced-carousel">
      <div class="carousel-container" id="carouselContainer">
        <div class="carousel-track" id="carouselTrack">
          <div class="carousel-slide">
            <img src="https://raw.githubusercontent.com/gainote/sexyfashion/refs/heads/main/images/2025_06_18/2025_06_18_36.webp" alt="女神肖像 1">
          </div>
          <div class="carousel-slide">
            <img src="https://raw.githubusercontent.com/gainote/sexyfashion/refs/heads/main/images/2025_06_18/2025_06_18_32.webp" alt="女神肖像 2">
          </div>
          <div class="carousel-slide">
            <img src="https://raw.githubusercontent.com/gainote/sexyfashion/refs/heads/main/images/2025_06_19/2025_06_19_07.webp" alt="女神肖像 3">
          </div>
          <div class="carousel-slide">
            <img src="https://raw.githubusercontent.com/gainote/sexyfashion/refs/heads/main/images/2025_06_18/2025_06_18_14.webp" alt="女神肖像 4">
          </div>
          <div class="carousel-slide">
            <img src="https://raw.githubusercontent.com/gainote/sexyfashion/refs/heads/main/images/2025_06_18/2025_06_18_03.webp" alt="女神肖像 5">
          </div>
        </div>
        <button class="carousel-nav prev" id="prevBtn"><i class="fas fa-chevron-left"></i></button>
        <button class="carousel-nav next" id="nextBtn"><i class="fas fa-chevron-right"></i></button>
        <div class="carousel-indicators" id="carouselIndicators"></div>
      </div>
    </div>
  </div>

  <!-- 靈感牆（瀑布流畫廊） -->
  <div class="masonry-container my-5">
    <div id="gallery" class="masonry-grid">
      <div class="grid-sizer"></div>
      <!-- 由 JavaScript 動態添加圖片卡片 -->
    </div>
    <div id="loading" class="loading" style="display:none;">載入中</div>
    <div id="endMessage" class="text-center py-4" style="display:none;">
      <div class="text-muted">
        <i class="fas fa-check-circle me-2"></i>已經到底囉！沒有更多作品了
      </div>
    </div>
  </div>

  <!-- 作品誌（燈箱＋資訊側欄） -->
  <div id="imageModal" class="modal">
    <span class="close-btn">×</span>
    <div class="modal-content-wrapper">
      <div class="modal-image-container">
        <img id="modalImage" class="modal-content" alt="放大作品" />
      </div>
      <div class="modal-info-panel">
        <div class="info-content">
          <h3 class="info-title"><i class="fas fa-palette"></i> 作品誌</h3>
          <div class="info-section">
            <div class="info-label"><i class="fas fa-image me-2"></i>檔案</div>
            <div class="info-value" id="infoFilename">載入中...</div>
          </div>
          <div class="info-section">
            <div class="info-label"><i class="fas fa-lightbulb me-2"></i>靈感 / 風格</div>
            <div class="info-value" id="infoPrompt">載入中...</div>
          </div>
          <div class="info-section">
            <div class="info-label"><i class="fas fa-calendar me-2"></i>創作日期</div>
            <div class="info-value" id="infoDate">載入中...</div>
          </div>
          <div class="info-section">
            <div class="info-label"><i class="fas fa-download me-2"></i>下載</div>
            <div class="info-value"><a href="#" id="imageDownload" download>下載原圖</a></div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- 頁尾 -->
  <footer class="text-center text-muted py-4" style="background:linear-gradient(90deg,#faf8fb,#f5f0f4)">
    © 2025 AIMuse Portraits | 典藏合作：contact@aimuse.art
  </footer>

  <!-- JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://unpkg.com/masonry-layout@4/dist/masonry.pkgd.min.js"></script>
  <script src="https://unpkg.com/imagesloaded@4/imagesloaded.pkgd.min.js"></script>

  <script>
    // Enhanced Carousel
    class EnhancedCarousel{
      constructor(container){
        this.container=container; this.track=container.querySelector('#carouselTrack'); this.slides=container.querySelectorAll('.carousel-slide');
        this.prevBtn=container.querySelector('#prevBtn'); this.nextBtn=container.querySelector('#nextBtn'); this.indicatorsContainer=container.querySelector('#carouselIndicators');
        this.currentIndex=0; this.slideCount=this.slides.length; this.isDragging=false; this.startX=0; this.currentX=0; this.initialTransform=0;
        this.init();
      }
      init(){this.createIndicators(); this.bindEvents(); this.updateCarousel(); this.startAutoplay();}
      createIndicators(){for(let i=0;i<this.slideCount;i++){const dot=document.createElement('div'); dot.className='carousel-indicator'; if(i===0) dot.classList.add('active'); dot.addEventListener('click',()=>this.goToSlide(i)); this.indicatorsContainer.appendChild(dot);}}
      bindEvents(){
        this.prevBtn.addEventListener('click',()=>this.prevSlide()); this.nextBtn.addEventListener('click',()=>this.nextSlide());
        this.container.addEventListener('mousedown',(e)=>this.dragStart(e)); this.container.addEventListener('touchstart',(e)=>this.dragStart(e),{passive:true});
        document.addEventListener('mousemove',(e)=>this.dragMove(e)); document.addEventListener('touchmove',(e)=>this.dragMove(e),{passive:true});
        document.addEventListener('mouseup',()=>this.dragEnd()); document.addEventListener('touchend',()=>this.dragEnd());
        document.addEventListener('keydown',(e)=>{if(e.key==='ArrowLeft') this.prevSlide(); if(e.key==='ArrowRight') this.nextSlide();});
        this.container.addEventListener('mouseenter',()=>this.pauseAutoplay()); this.container.addEventListener('mouseleave',()=>this.startAutoplay());
      }
      dragStart(e){this.isDragging=true; this.startX=e.type==='mousedown'?e.clientX:e.touches[0].clientX; this.initialTransform=-this.currentIndex*100; this.track.style.transition='none'; this.pauseAutoplay();}
      dragMove(e){if(!this.isDragging) return; e.preventDefault(); this.currentX=e.type==='mousemove'?e.clientX:e.touches[0].clientX; const deltaX=this.currentX-this.startX; const movePercent=(deltaX/this.container.offsetWidth)*100; this.track.style.transform=`translateX(${this.initialTransform+movePercent}%)`;}
      dragEnd(){if(!this.isDragging) return; this.isDragging=false; const deltaX=this.currentX-this.startX; const threshold=this.container.offsetWidth*0.1; this.track.style.transition='transform .5s cubic-bezier(.25,.46,.45,.94)'; if(Math.abs(deltaX)>threshold){deltaX>0?this.prevSlide():this.nextSlide();}else{this.updateCarousel();} this.startAutoplay();}
      goToSlide(i){this.currentIndex=i; this.updateCarousel(); this.pauseAutoplay(); this.startAutoplay();}
      nextSlide(){this.currentIndex=(this.currentIndex+1)%this.slideCount; this.updateCarousel();}
      prevSlide(){this.currentIndex=(this.currentIndex-1+this.slideCount)%this.slideCount; this.updateCarousel();}
      updateCarousel(){const x=-this.currentIndex*100; this.track.style.transform=`translateX(${x}%)`; const dots=this.indicatorsContainer.querySelectorAll('.carousel-indicator'); dots.forEach((d,idx)=>d.classList.toggle('active', idx===this.currentIndex));}
      startAutoplay(){this.pauseAutoplay(); this.autoplayTimer=setInterval(()=>this.nextSlide(), 5000);} 
      pauseAutoplay(){if(this.autoplayTimer) clearInterval(this.autoplayTimer);} 
    }

    document.addEventListener('DOMContentLoaded',()=>{new EnhancedCarousel(document.getElementById('carouselContainer'));});

    // Gallery & Modal
    const gallery=document.getElementById('gallery');
    const imageModal=document.getElementById('imageModal');
    const modalImage=document.getElementById('modalImage');
    const closeBtn=document.querySelector('.close-btn');
    const loadingDiv=document.getElementById('loading');
    const endMessageDiv=document.getElementById('endMessage');
    let currentDate=new Date(); let loading=false; let hasReachedEnd=false; const loadedDates=new Set(); let masonryInstance=null;

    function formatDate(date){return date.toISOString().split('T')[0].replace(/-/g,'_')}
    function showLoading(){if(!hasReachedEnd) loadingDiv.style.display='block'}
    function hideLoading(){loadingDiv.style.display='none'}
    function showEndMessage(){hideLoading(); endMessageDiv.style.display='block'; hasReachedEnd=true}
    function initMasonry(){if(!masonryInstance){masonryInstance=new Masonry(gallery,{itemSelector:'.grid-item', columnWidth:'.grid-sizer', gutter:15, percentPosition:true});}}

    function loadImageJson(dateStr, retryCount=0){
      if(hasReachedEnd) return; if(loadedDates.has(dateStr)){loadPreviousDate(); return;}
      if(retryCount>=30){showEndMessage(); loading=false; return;}
      showLoading(); const jsonUrl=`images/${dateStr}/data.json`;
      fetch(jsonUrl).then(res=>{if(!res.ok) throw new Error(`HTTP ${res.status}`); return res.json();})
      .then(data=>{
        if(!data.images || data.images.length===0){currentDate.setDate(currentDate.getDate()-1); const newDateStr=formatDate(currentDate); setTimeout(()=>loadImageJson(newDateStr, retryCount+1), 100); return;}
        loadedDates.add(dateStr); renderImages(data.images); setTimeout(()=>loadPreviousDate(), 200);
      })
      .catch(()=>{currentDate.setDate(currentDate.getDate()-1); const newDateStr=formatDate(currentDate); setTimeout(()=>loadImageJson(newDateStr, retryCount+1), 100);})
      .finally(()=>{if(retryCount===0){setTimeout(hideLoading, 500);}});
    }

    function renderImages(images){
      const newEls=[];
      images.forEach(imgObj=>{
        const item=document.createElement('div'); item.className='grid-item';
        const card=document.createElement('div'); card.className='card shadow-sm';
        const ph=document.createElement('div'); ph.className='image-placeholder'; card.appendChild(ph);
        const img=document.createElement('img'); img.src=imgObj.thumb_path; img.className='card-img-top img-fluid'; img.loading='lazy'; img.alt=imgObj.alt||'AI 女神肖像'; img.style.display='none';
        img.onload=function(){ph.remove(); this.style.display='block'; this.classList.add('loaded'); if(masonryInstance) masonryInstance.layout();}
        img.onerror=function(){ph.remove(); item.remove();}

        img.addEventListener('click',()=>{modalImage.src=imgObj.filename; modalImage.style.transform='scale(1)'; modalImage.classList.remove('zoomed'); updateModalInfo(imgObj); imageModal.classList.add('show');});

        card.appendChild(img); item.appendChild(card); newEls.push(item);
      });

      newEls.forEach(el=>gallery.appendChild(el));
      if(!masonryInstance) initMasonry(); else masonryInstance.appended(newEls);
      imagesLoaded(newEls,()=>{if(masonryInstance) masonryInstance.layout(); loading=false;});
    }

    function updateModalInfo(imgObj){
      const infoFilename=document.getElementById('infoFilename');
      const infoPrompt=document.getElementById('infoPrompt');
      const infoDate=document.getElementById('infoDate');
      const imageDownload=document.getElementById('imageDownload');

      const parts=imgObj.filename.split('/');
      const fileName=parts[parts.length-1];
      const datePart=parts[parts.length-2];

      infoFilename.textContent=fileName||'未知檔案';
      infoPrompt.textContent=imgObj.prompt||imgObj.alt||'—';
      infoDate.textContent=datePart?datePart.replace(/_/g,'-'):'未知日期';
      imageDownload.href=imgObj.filename;
    }

    function loadPreviousDate(){currentDate.setDate(currentDate.getDate()-1); setTimeout(()=>loadNextBatch(), 200)}
    function loadNextBatch(){if(loading||hasReachedEnd) return; loading=true; const dateStr=formatDate(currentDate); loadImageJson(dateStr, 0)}

    // 启动
    loadNextBatch();

    // 無限滾動
    let scrollTimeout; window.addEventListener('scroll',()=>{clearTimeout(scrollTimeout); scrollTimeout=setTimeout(()=>{if(!hasReachedEnd && window.innerHeight+window.scrollY>=document.body.offsetHeight-200){loadNextBatch();}}, 100)});

    // Modal 操作
    const modalImageClick=(e)=>{e.stopPropagation(); const isZoomed=modalImage.classList.contains('zoomed'); if(isZoomed){modalImage.style.transform='scale(1)'; modalImage.classList.remove('zoomed');}else{modalImage.style.transform='scale(1.5)'; modalImage.classList.add('zoomed');}};
    modalImage.addEventListener('click', modalImageClick);
    document.querySelector('.close-btn').addEventListener('click',()=>imageModal.classList.remove('show'));
    imageModal.addEventListener('click',(e)=>{if(e.target===imageModal || e.target.closest('.modal-image-container')) imageModal.classList.remove('show')});
    document.addEventListener('keydown',(e)=>{if(e.key==='Escape') imageModal.classList.remove('show')});

    let resizeTimeout; window.addEventListener('resize',()=>{clearTimeout(resizeTimeout); resizeTimeout=setTimeout(()=>{if(masonryInstance) masonryInstance.layout();}, 250)});
  </script>
</body>
</html>
